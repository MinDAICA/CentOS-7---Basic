Hiá»ƒu rá»“i Dong ğŸ‘. Váº¥n Ä‘á» cá»§a báº¡n lÃ : ELRepo khÃ´ng giá»¯ láº¡i cÃ¡c báº£n kernel-ml/lts cÅ© trong thÆ° má»¥c chÃ­nh, nÃªn khi báº¡n wget theo tÃªn cá»¥ thá»ƒ (5.15.152, 6.10.5â€¦) thÃ¬ sáº½ bá»‹ 404 Not Found.

ğŸ‘‰ CÃ¡ch xá»­ lÃ½ triá»‡t Ä‘á»ƒ lÃ  dÃ¹ng mirror archive cá»§a ELRepo, nÆ¡i há» lÆ°u láº¡i táº¥t cáº£ cÃ¡c báº£n kernel cÅ©, hoáº·c cÃ i trá»±c tiáº¿p qua yum tá»« repo elrepo-kernel thay vÃ¬ wget thá»§ cÃ´ng.

ğŸ”§ Giáº£i phÃ¡p 1: DÃ¹ng mirror archive (á»•n Ä‘á»‹nh nháº¥t)
ELRepo cÃ³ mirror archive á»Ÿ Ä‘Ã¢y: ğŸ‘‰ https://mirrors.coreix.net/elrepo-archive-archive/kernel/el7/x86_64/RPMS/
Táº¡i Ä‘Ã³ báº¡n sáº½ tháº¥y Ä‘áº§y Ä‘á»§ cÃ¡c gÃ³i .rpm cho kernel-ml vÃ  kernel-lt.
VÃ­ dá»¥, Ä‘á»ƒ cÃ i báº£n kernel-lt 5.4.x LTS (á»•n Ä‘á»‹nh, phÃ¹ há»£p CentOS 7):

bash
cd /tmp
wget https://mirrors.coreix.net/elrepo-archive-archive/kernel/el7/x86_64/RPMS/kernel-lt-5.4.278-1.el7.elrepo.x86_64.rpm
wget https://mirrors.coreix.net/elrepo-archive-archive/kernel/el7/x86_64/RPMS/kernel-lt-devel-5.4.278-1.el7.elrepo.x86_64.rpm
wget https://mirrors.coreix.net/elrepo-archive-archive/kernel/el7/x86_64/RPMS/kernel-lt-headers-5.4.278-1.el7.elrepo.x86_64.rpm

sudo rpm -ivh kernel-lt-*.rpm
DÃ¹ng -i Ä‘á»ƒ cÃ i song song, giá»¯ láº¡i kernel cÅ© phÃ²ng khi boot lá»—i.

ğŸ”§ Giáº£i phÃ¡p 2: DÃ¹ng yum vá»›i repo elrepo-kernel
Náº¿u máº¡ng cá»§a báº¡n cho phÃ©p, báº¡n cÃ³ thá»ƒ thá»­ láº¡i vá»›i yum (nhÆ°ng cáº§n bypass mirrorlist):

bash
sudo yum --disablerepo="*" --enablerepo="elrepo-kernel" list available | grep kernel
sudo yum --enablerepo=elrepo-kernel install kernel-lt
ğŸ”§ Sau khi cÃ i xong
Táº¡o láº¡i grub config:

bash
sudo grub2-mkconfig -o /boot/grub2/grub.cfg
Äáº·t kernel má»›i lÃ m máº·c Ä‘á»‹nh:

bash
sudo grub2-set-default 0
Reboot:

bash
sudo reboot
Kiá»ƒm tra:

bash
uname -sr
ğŸ‘‰ Náº¿u tháº¥y Linux 5.4.x â†’ thÃ nh cÃ´ng ğŸ‰

âœ… Káº¿t luáº­n
Báº¡n bá»‹ 404 vÃ¬ gá»i tháº³ng báº£n kernel Ä‘Ã£ bá»‹ gá»¡.
CÃ¡ch triá»‡t Ä‘á»ƒ: dÃ¹ng mirror archive (link á»Ÿ trÃªn) Ä‘á»ƒ táº£i Ä‘Ãºng báº£n .rpm.
Khuyáº¿n nghá»‹: dÃ¹ng kernel-lt 5.4.x cho CentOS 7 (á»•n Ä‘á»‹nh, há»— trá»£ lÃ¢u dÃ i).
ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh chá»n luÃ´n 3 link chÃ­nh xÃ¡c má»›i nháº¥t cá»§a kernel-lt (5.4.x) tá»« mirror archive Ä‘á»ƒ báº¡n copyâ€‘paste cháº¡y ngay khÃ´ng?
------
Chuáº©n rá»“i Dong ğŸ‘. GÃ³i kernel-lt-devel yÃªu cáº§u gÃ³i perl vÃ¬ nÃ³ cáº§n Perl Ä‘á»ƒ biÃªn dá»‹ch module hoáº·c xá»­ lÃ½ script trong quÃ¡ trÃ¬nh cÃ i Ä‘áº·t. ÄÃ¢y lÃ  lá»—i phá»¥ thuá»™c Ä‘Æ¡n giáº£n, xá»­ lÃ½ ráº¥t nhanh.

âœ… CÃ¡ch kháº¯c phá»¥c
Chá»‰ cáº§n cÃ i gÃ³i perl trÆ°á»›c khi cÃ i kernel:

bash
sudo yum install -y perl
Sau Ä‘Ã³ cháº¡y láº¡i lá»‡nh cÃ i kernel:

bash
sudo rpm -ivh kernel-lt-*.rpm
ğŸ” Náº¿u báº¡n Ä‘Ã£ táº£i kernel-lt báº£n 5.4.278
ThÃ¬ sau khi cÃ i xong, tiáº¿p tá»¥c:

bash
sudo grub2-mkconfig -o /boot/grub2/grub.cfg
sudo grub2-set-default 0
sudo reboot
Sau khi mÃ¡y khá»Ÿi Ä‘á»™ng láº¡i:

bash
uname -sr
ğŸ‘‰ Náº¿u tháº¥y Linux 5.4.278 â†’ báº¡n Ä‘Ã£ nÃ¢ng kernel thÃ nh cÃ´ng ğŸ‰


QuÃ¡ tuyá»‡t vá»i Dong Æ¡i! Cluster Kind Ä‘Ã£ khá»Ÿi táº¡o thÃ nh cÃ´ng trÃªn CentOS 7 vá»›i image v1.24.15 â€” chá»©ng tá» phÆ°Æ¡ng Ã¡n dÃ¹ng báº£n Kubernetes nháº¹ hÆ¡n Ä‘Ã£ xá»­ lÃ½ triá»‡t Ä‘á»ƒ váº¥n Ä‘á» cgroup v2 rá»“i Ä‘Ã³.

âœ… Giá» báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u lÃ m gÃ¬?
ğŸ” Kiá»ƒm tra cluster hoáº¡t Ä‘á»™ng
    bash
    kubectl get nodes
    kubectl get pods -A
ğŸš€ Triá»ƒn khai thá»­ má»™t app
    bash
    kubectl create deployment hello --image=nginx
    kubectl expose deployment hello --port=80 --type=NodePort
    kubectl get svc
  ğŸ“¦ CÃ i thÃªm tiá»‡n Ã­ch
    Ingress Controller
    Metrics Server
    Helm
    Dashboard

ğŸ§  Gá»£i Ã½ tiáº¿p theo
Báº¡n muá»‘n:
Deploy thá»­ Helm chart?
CÃ i Ingress Ä‘á»ƒ expose app ra ngoÃ i?
TÃ­ch há»£p CI/CD nhÆ° GitHub Actions hoáº·c Jenkins?
Viáº¿t script tá»± Ä‘á»™ng khá»Ÿi táº¡o cluster vÃ  deploy app?
MÃ¬nh cÃ³ thá»ƒ giÃºp báº¡n tá»«ng bÆ°á»›c. Giá» cluster Ä‘Ã£ sáºµn sÃ ng, báº¡n muá»‘n lÃ m gÃ¬ tiáº¿p theo?

---
[root@localhost ~]# kubectl get nodes 



[root@localhost ~]# kubectl get nodes
NAME                 STATUS   ROLES           AGE     VERSION
demo-control-plane   Ready    control-plane   3m38s   v1.24.15

NAMESPACE            NAME                                         READY   STATUS    RESTARTS   AGE
kube-system          coredns-57575c5f89-kd7hx                     1/1     Running   0          3m25s
kube-system          coredns-57575c5f89-nmd2l                     1/1     Running   0          3m25s
kube-system          etcd-demo-control-plane                      1/1     Running   0          3m40s
kube-system          kindnet-5czr4                                1/1     Running   0          3m25s
kube-system          kube-apiserver-demo-control-plane            1/1     Running   0          3m40s
kube-system          kube-controller-manager-demo-control-plane   1/1     Running   0          3m40s
kube-system          kube-proxy-m4hhz                             1/1     Running   0          3m25s
kube-system          kube-scheduler-demo-control-plane            1/1     Running   0          3m40s
local-path-storage   local-path-provisioner-c49b7b56f-2flxc       1/1     Running   0          3m25s

QuÃ¡ Ä‘áº¹p luÃ´n Dong Æ¡i ğŸ‰. Cluster Kind cá»§a báº¡n Ä‘Ã£ lÃªn hoÃ n chá»‰nh, má»i thÃ nh pháº§n control-plane vÃ  CNI Ä‘á»u Ä‘ang á»Ÿ tráº¡ng thÃ¡i Running. ÄÃ¢y lÃ  dáº¥u hiá»‡u cá»§a má»™t cluster á»•n Ä‘á»‹nh, sáºµn sÃ ng Ä‘á»ƒ triá»ƒn khai á»©ng dá»¥ng.

âœ… TÃ¬nh tráº¡ng hiá»‡n táº¡i
ThÃ nh pháº§n	Tráº¡ng thÃ¡i
Node	demo-control-plane â†’ Ready
CoreDNS	2 pods â†’ Running
etcd, kube-apiserver, scheduler, controller-manager	Táº¥t cáº£ Running
kindnet (CNI)	Running
kube-proxy	Running
StorageClass (local-path)	Running
ğŸ‘‰ Báº¡n Ä‘ang cÃ³ má»™t single-node Kubernetes cluster hoÃ n chá»‰nh, cÃ³ DNS, máº¡ng, storage, vÃ  sáºµn sÃ ng Ä‘á»ƒ deploy app.

ğŸš€ Gá»£i Ã½ tiáº¿p theo
Báº¡n cÃ³ thá»ƒ thá»­:

1. Triá»ƒn khai á»©ng dá»¥ng máº«u
bash
kubectl create deployment hello --image=nginx
kubectl expose deployment hello --port=80 --type=NodePort
kubectl get svc
2. CÃ i Helm (náº¿u báº¡n dÃ¹ng chart)
bash
curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash
3. CÃ i Ingress Controller
bash
kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.2.1/deploy/static/provider/kind/deploy.yaml
4. CÃ i Dashboard
bash
kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml
Báº¡n muá»‘n mÃ¬nh giÃºp viáº¿t má»™t script tá»± Ä‘á»™ng deploy app + expose + test luÃ´n khÃ´ng? Hay báº¡n muá»‘n triá»ƒn khai Helm chart, Ingress, hoáº·c CI/CD tiáº¿p theo?

Kiá»ƒm tra Helm hoáº¡t Ä‘á»™ng
Cháº¡y:
bash
helm version
â†’ Káº¿t quáº£ sáº½ lÃ :
Code
version.BuildInfo{Version:"v3.19.0", ...}

âš ï¸ LÆ°u Ã½ nhá»
DÃ²ng cáº£nh bÃ¡o:
Code
[WARNING] Could not find git. It is required for plugin installation.
â†’ KhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n viá»‡c dÃ¹ng Helm Ä‘á»ƒ cÃ i chart. Chá»‰ khi báº¡n muá»‘n dÃ¹ng Helm plugin thÃ¬ má»›i cáº§n cÃ i git.
Náº¿u muá»‘n cÃ i git:
bash
    sudo yum install -y git

ğŸš€ Gá»£i Ã½ tiáº¿p theo: CÃ i thá»­ Helm chart
VÃ­ dá»¥: cÃ i NGINX báº±ng Helm
bash
    helm repo add bitnami https://charts.bitnami.com/bitnami
    helm repo update
    helm install my-nginx bitnami/nginx
    kubectl get svc
ğŸ‘‰ Báº¡n sáº½ tháº¥y service my-nginx Ä‘Æ°á»£c táº¡o, cÃ³ thá»ƒ expose ra ngoÃ i báº±ng NodePort hoáº·c Ingress.

Báº¡n muá»‘n mÃ¬nh giÃºp deploy má»™t app cá»¥ thá»ƒ báº±ng Helm khÃ´ng? VÃ­ dá»¥ nhÆ° WordPress, Redis, PostgreSQL, hoáº·c má»™t app cá»§a báº¡n?


[root@localhost ~]# kubectl get svc
NAME         TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                      AGE
hello        NodePort       10.96.50.167    <none>        80:32404/TCP                 4m23s
kubernetes   ClusterIP      10.96.0.1       <none>        443/TCP                      21m
my-nginx     LoadBalancer   10.96.192.123   <pending>     80:31012/TCP,443:30400/TCP   0s

Tuyá»‡t vá»i Dong ğŸ¯. Cluster Kind cá»§a báº¡n Ä‘ang hoáº¡t Ä‘á»™ng ráº¥t tá»‘t, vÃ  mÃ¬nh tháº¥y báº¡n Ä‘Ã£ triá»ƒn khai:

âœ… hello â†’ kiá»ƒu NodePort, Ä‘Ã£ expose cá»•ng 80 ra ngoÃ i qua 32404
âœ… my-nginx â†’ kiá»ƒu LoadBalancer, nhÆ°ng Ä‘ang á»Ÿ tráº¡ng thÃ¡i EXTERNAL-IP: <pending>
ğŸ” VÃ¬ sao LoadBalancer bá»‹ pending?
Kind lÃ  má»™t cluster cháº¡y trong Docker, khÃ´ng cÃ³ cloud provider nhÆ° AWS, GCP, hay Azure â†’ kiá»ƒu LoadBalancer sáº½ khÃ´ng tá»± cáº¥p IP Ä‘Æ°á»£c.
ğŸ‘‰ VÃ¬ váº­y, EXTERNAL-IP sáº½ luÃ´n lÃ  <pending> trá»« khi báº¡n cÃ i thÃªm má»™t LoadBalancer ná»™i bá»™ nhÆ°:

âœ… 1. MetalLB â€“ cáº¥p IP ná»™i bá»™ cho dá»‹ch vá»¥ kiá»ƒu LoadBalancer
CÃ i MetalLB:
bash
kubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.13.10/config/manifests/metallb-native.yaml
Táº¡o cáº¥u hÃ¬nh IP range:
yaml
            cat <<EOF | kubectl apply -f -
            apiVersion: metallb.io/v1beta1
            kind: IPAddressPool
            metadata:
              name: kind-pool
              namespace: metallb-system
            spec:
              addresses:
              - 172.18.255.1-172.18.255.250
            ---
            apiVersion: metallb.io/v1beta1
            kind: L2Advertisement
            metadata:
              name: kind-advert
              namespace: metallb-system
            spec:
              ipAddressPools:
              - kind-pool
            EOF
ğŸ‘‰ Sau Ä‘Ã³, my-nginx sáº½ Ä‘Æ°á»£c cáº¥p IP tháº­t tá»« dáº£i 172.18.255.x vÃ  báº¡n cÃ³ thá»ƒ truy cáº­p qua IP Ä‘Ã³.
âœ… Hoáº·c dÃ¹ng NodePort Ä‘á»ƒ truy cáº­p ngay
Báº¡n Ä‘Ã£ cÃ³:
bash
hello        NodePort       ...        80:32404/TCP
â†’ Truy cáº­p báº±ng IP mÃ¡y host (VM hoáº·c mÃ¡y tháº­t):

Code
http://<host-ip>:32404
Báº¡n muá»‘n mÃ¬nh giÃºp cÃ i MetalLB Ä‘áº§y Ä‘á»§ vÃ  test truy cáº­p my-nginx qua IP tháº­t khÃ´ng? Hay báº¡n muá»‘n expose thÃªm app qua Ingress Ä‘á»ƒ dÃ¹ng domain nhÆ° hello.local?

