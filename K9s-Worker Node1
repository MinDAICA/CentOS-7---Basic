ÄÃºng rá»“i Dong ğŸ‘ â€” cÃ¡c thao tÃ¡c trÃªn worker node sáº½ gáº§n nhÆ° tÆ°Æ¡ng tá»± nhÆ° trÃªn master, chá»‰ khÃ¡c á»Ÿ chá»— khÃ´ng cháº¡y kubeadm init, mÃ  thay vÃ o Ä‘Ã³ lÃ  kubeadm join Ä‘á»ƒ káº¿t ná»‘i vÃ o cluster.

ğŸ§© TÃ³m táº¯t cÃ¡c bÆ°á»›c cáº§n thá»±c hiá»‡n trÃªn má»—i Worker Node (worker1161, worker1162)
ğŸ”§ 1. Äáº·t hostname
bash
hostnamectl set-hostname worker1161  # hoáº·c worker1162
ğŸ”¥ 2. Táº¯t swap, firewall, SELinux
bash
swapoff -a
sed -i '/swap/d' /etc/fstab

systemctl stop firewalld
systemctl disable firewalld

setenforce 0
sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config
ğŸ³ 3. CÃ i container runtime (Docker hoáº·c containerd)
VÃ­ dá»¥ náº¿u báº¡n dÃ¹ng Docker:

bash
curl -fsSL https://get.docker.com | sh
systemctl enable docker
systemctl start docker
Hoáº·c náº¿u báº¡n dÃ¹ng containerd, mÃ¬nh cÃ³ thá»ƒ hÆ°á»›ng dáº«n riÃªng.

ğŸ“¦ 4. CÃ i kubeadm, kubelet, kubectl
bash
cat <<EOF > /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\$basearch
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg
       https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
exclude=kubelet kubeadm kubectl
EOF

yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes
systemctl enable kubelet
ğŸŒ 5. Cáº¥u hÃ¬nh máº¡ng kernel
bash
modprobe br_netfilter

cat <<EOF > /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF

sysctl --system
ğŸ¤ 6. Tham gia vÃ o cluster
Cháº¡y lá»‡nh kubeadm join mÃ  báº¡n nháº­n Ä‘Æ°á»£c tá»« master:

bash
kubeadm join 192.168.1.160:6443 --token gxonk8.fpo988blh0pyzlzl \
  --discovery-token-ca-cert-hash sha256:17a5e0c161d0fb8709ea58c6512f422032692365506c364170d1ff1b22520158
âœ… 7. Kiá»ƒm tra trÃªn master
TrÃªn master1160, cháº¡y:

bash
kubectl get nodes
Báº¡n sáº½ tháº¥y cáº£ worker1161 vÃ  worker1162 á»Ÿ tráº¡ng thÃ¡i Ready.





[root@worker1161 ~]# kubeadm join 192.168.1.160:6443 \
>   --token 5d6kjx.nwxq64fivgn4nn9k \
>   --discovery-token-ca-cert-hash sha256:17a5e0c161d0fb8709ea58c6512f422032692365506c364170d1ff1b22520158 \
>   --cri-socket unix:///var/run/cri-dockerd.sock
[preflight] Running pre-flight checks
[preflight] Reading configuration from the cluster...
[preflight] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -o yaml'
[kubelet-start] Writing kubelet configuration to file "/var/lib/kubelet/config.yaml"
[kubelet-start] Writing kubelet environment file with flags to file "/var/lib/kubelet/kubeadm-flags.env"
[kubelet-start] Starting the kubelet
[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...

This node has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run 'kubectl get nodes' on the control-plane to see this node join the cluster.

